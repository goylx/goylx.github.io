---
author: 欧阳罗霄
title:  git及版本控制
categories: 
	- git
tags:
	- git
references:
  - title: 《Git Pro2中文Gitbook》
    url: https://bingohuang.gitbooks.io/progit2/content/01-introduction/sections/about-version-control.html
  - title: 高质量的 Git 中文教程
    url : https://github.com/geeeeeeeeek/git-recipes
---
## 关于版本控制
版本控制用于记录一个或多个文件内容变更，以方便将来查询修订情况。使用版本控制就可以将某个文件回溯到之前的状态，甚至将整个项目都回退到过去某个时间点的状态，你可以比较文件的变化细节，查出最后是谁修改了哪个地方，从而找出导致怪异问题出现的原因，又是谁在何时报告了某个功能缺陷等等。
目前基本都是使用分布式版本控制系统，每个客户端都保存一份完整的仓库镜像，并通过中心服务器保持每个镜像之间同步。这类系统都可以指定和若干不同的远端代码仓库进行交互。籍此，你就可以在同一个项目中，分别和不同工作小组的人相互协作。 你可以根据需要设定不同的协作流程，比如层次模型式的工作流。
{% image /image/Devops/git/versionControl.png, alt=分布式版本控制系统 %}

## git基础
- 分布式版本控制
  git作为一种分布式版本控制系统。在每一个客户端都持有一份完整的仓库镜像，因此近乎所有的操作都可以直接在本地执行。举个例子，要浏览项目的历史，Git 不需外连到服务器去获取历史，然后再显示出来——它只需直接从本地数据库中读取。 你能立即看到项目历史。 如果你想查看当前版本与一个月前的版本之间引入的修改，Git 会查找到一个月前的文件做一次本地的差异计算，而不是由远程服务器处理或从远程服务器拉回旧版本文件再来本地处理。
- 存储版本的方式
  git把不同版本的文件作为小型文件系统的一组快照，每次提交或保存一个新的版本时将当时的全部文件制作为一份快照并保存这份快照的索引，为了高效，如果文件没有修改，Git 不再重新存储该文件，而是只保留一个链接指向之前存储的文件。 Git 对待数据更像是一个 快照流。
  {% image /image/Devops/git/snapshots.png, alt=存储项目版本为快照流 %}
- 保证数据完整性
  git在存储数据前会根据文件内容以及文件的目录生成一个散列hash值，Git 数据库中保存的信息都是以文件内容的哈希值来索引。任何文件的改动都会被git监测到， 这意味着不可能在 Git 不知情时更改任何文件内容或目录内容。

### 文件的四种状态
处于git管理下的文件一共有四种状态，已修改（modified）、已暂存（staged）、已提交（committed）、已推送（pushed）。 已修改表示修改了文件，但还没保存到数据库中。 已暂存表示对一个已修改文件的当前版本做了标记，使之包含在下次提交的快照中。已提交表示数据已经安全的保存在本地数据库中。已推送表示已经将本地仓库中的快照保存到本地远程仓库且推送到远程仓库中。由此引入 Git 项目的三个工作区域的概念：Git 仓库、工作目录以及暂存区域。
{% image /image/Devops/git/zone.png, alt=git项目的五个工作区域，本地远程仓库相当于远程仓库的镜像每次fetch/pull/push都会和远程仓库保持一致 %}
- Git 仓库目录是 Git 用来保存项目的元数据和对象数据库的地方。 这是 Git 中最重要的部分，从其它计算机克隆仓库时，拷贝的就是这里的数据。
- 工作目录是对项目的某个版本独立提取出来的内容。 这些从 Git 仓库的压缩数据库中提取出来的文件，放在磁盘上供你使用或修改。
- 暂存区域是一个文件，保存了下次将提交的文件列表信息，一般在 Git 仓库目录中。 有时候也被称作``索引''，不过一般说法还是叫暂存区域。

基本的 Git 工作流程如下：
1. 在工作目录中修改文件。
2. 暂存文件，将文件的快照放入暂存区域。
3. 提交更新，找到暂存区域的文件，将快照永久性存储到 Git 仓库目录。